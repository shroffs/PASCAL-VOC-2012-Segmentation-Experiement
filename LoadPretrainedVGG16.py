#an ugly solution but it works

def load_pretraining(net_dict, pretrained_dict):
    net_dict["contract1.conv1.weight"] = pretrained_dict["features.0.weight"]
    net_dict["contract1.conv1.bias"] = pretrained_dict["features.0.bias"]
    net_dict["contract1.bn1.weight"] = pretrained_dict["features.1.weight"]
    net_dict["contract1.bn1.bias"] = pretrained_dict["features.1.bias"]
    net_dict["contract1.bn1.running_mean"] = pretrained_dict["features.1.running_mean"]
    net_dict["contract1.bn1.running_var"] = pretrained_dict["features.1.running_var"]

    net_dict["contract1.conv2.weight"] = pretrained_dict["features.3.weight"]
    net_dict["contract1.conv2.bias"] = pretrained_dict["features.3.bias"]
    net_dict["contract1.bn2.weight"] = pretrained_dict["features.4.weight"]
    net_dict["contract1.bn2.bias"] = pretrained_dict["features.4.bias"]
    net_dict["contract1.bn2.running_mean"] = pretrained_dict["features.4.running_mean"]
    net_dict["contract1.bn2.running_var"] = pretrained_dict["features.4.running_var"]

    net_dict["contract2.conv1.weight"] = pretrained_dict["features.7.weight"]
    net_dict["contract2.conv1.bias"] = pretrained_dict["features.7.bias"]
    net_dict["contract2.bn1.weight"] = pretrained_dict["features.8.weight"]
    net_dict["contract2.bn1.bias"] = pretrained_dict["features.8.bias"]
    net_dict["contract2.bn1.running_mean"] = pretrained_dict["features.8.running_mean"]
    net_dict["contract2.bn1.running_var"] = pretrained_dict["features.8.running_var"]

    net_dict["contract2.conv2.weight"] = pretrained_dict["features.10.weight"]
    net_dict["contract2.conv2.bias"] = pretrained_dict["features.10.bias"]
    net_dict["contract2.bn2.weight"] = pretrained_dict["features.11.weight"]
    net_dict["contract2.bn2.bias"] = pretrained_dict["features.11.bias"]
    net_dict["contract2.bn2.running_mean"] = pretrained_dict["features.11.running_mean"]
    net_dict["contract2.bn2.running_var"] = pretrained_dict["features.11.running_var"]

    net_dict["contract3.conv1.weight"] = pretrained_dict["features.14.weight"]
    net_dict["contract3.conv1.bias"] = pretrained_dict["features.14.bias"]
    net_dict["contract3.bn1.weight"] = pretrained_dict["features.15.weight"]
    net_dict["contract3.bn1.bias"] = pretrained_dict["features.15.bias"]
    net_dict["contract3.bn1.running_mean"] = pretrained_dict["features.15.running_mean"]
    net_dict["contract3.bn1.running_var"] = pretrained_dict["features.15.running_var"]

    net_dict["contract3.conv2.weight"] = pretrained_dict["features.17.weight"]
    net_dict["contract3.conv2.bias"] = pretrained_dict["features.17.bias"]
    net_dict["contract3.bn2.weight"] = pretrained_dict["features.18.weight"]
    net_dict["contract3.bn2.bias"] = pretrained_dict["features.18.bias"]
    net_dict["contract3.bn2.running_mean"] = pretrained_dict["features.18.running_mean"]
    net_dict["contract3.bn2.running_var"] = pretrained_dict["features.18.running_var"]

    net_dict["contract3.conv3.weight"] = pretrained_dict["features.20.weight"]
    net_dict["contract3.conv3.bias"] = pretrained_dict["features.20.bias"]
    net_dict["contract3.bn3.weight"] = pretrained_dict["features.21.weight"]
    net_dict["contract3.bn3.bias"] = pretrained_dict["features.21.bias"]
    net_dict["contract3.bn3.running_mean"] = pretrained_dict["features.21.running_mean"]
    net_dict["contract3.bn3.running_var"] = pretrained_dict["features.21.running_var"]

    net_dict["contract4.conv1.weight"] = pretrained_dict["features.24.weight"]
    net_dict["contract4.conv1.bias"] = pretrained_dict["features.24.bias"]
    net_dict["contract4.bn1.weight"] = pretrained_dict["features.25.weight"]
    net_dict["contract4.bn1.bias"] = pretrained_dict["features.25.bias"]
    net_dict["contract4.bn1.running_mean"] = pretrained_dict["features.25.running_mean"]
    net_dict["contract4.bn1.running_var"] = pretrained_dict["features.25.running_var"]

    net_dict["contract4.conv2.weight"] = pretrained_dict["features.27.weight"]
    net_dict["contract4.conv2.bias"] = pretrained_dict["features.27.bias"]
    net_dict["contract4.bn2.weight"] = pretrained_dict["features.28.weight"]
    net_dict["contract4.bn2.bias"] = pretrained_dict["features.28.bias"]
    net_dict["contract4.bn2.running_mean"] = pretrained_dict["features.28.running_mean"]
    net_dict["contract4.bn2.running_var"] = pretrained_dict["features.28.running_var"]

    net_dict["contract4.conv3.weight"] = pretrained_dict["features.30.weight"]
    net_dict["contract4.conv3.bias"] = pretrained_dict["features.30.bias"]
    net_dict["contract4.bn3.weight"] = pretrained_dict["features.31.weight"]
    net_dict["contract4.bn3.bias"] = pretrained_dict["features.31.bias"]
    net_dict["contract4.bn3.running_mean"] = pretrained_dict["features.31.running_mean"]
    net_dict["contract4.bn3.running_var"] = pretrained_dict["features.31.running_var"]

    net_dict["contract5.conv1.weight"] = pretrained_dict["features.34.weight"]
    net_dict["contract5.conv1.bias"] = pretrained_dict["features.34.bias"]
    net_dict["contract5.bn1.weight"] = pretrained_dict["features.35.weight"]
    net_dict["contract5.bn1.bias"] = pretrained_dict["features.35.bias"]
    net_dict["contract5.bn1.running_mean"] = pretrained_dict["features.35.running_mean"]
    net_dict["contract5.bn1.running_var"] = pretrained_dict["features.35.running_var"]

    net_dict["contract5.conv2.weight"] = pretrained_dict["features.37.weight"]
    net_dict["contract5.conv2.bias"] = pretrained_dict["features.37.bias"]
    net_dict["contract5.bn2.weight"] = pretrained_dict["features.38.weight"]
    net_dict["contract5.bn2.bias"] = pretrained_dict["features.38.bias"]
    net_dict["contract5.bn2.running_mean"] = pretrained_dict["features.38.running_mean"]
    net_dict["contract5.bn2.running_var"] = pretrained_dict["features.38.running_var"]

    net_dict["contract5.conv3.weight"] = pretrained_dict["features.40.weight"]
    net_dict["contract5.conv3.bias"] = pretrained_dict["features.40.bias"]
    net_dict["contract5.bn3.weight"] = pretrained_dict["features.41.weight"]
    net_dict["contract5.bn3.bias"] = pretrained_dict["features.41.bias"]
    net_dict["contract5.bn3.running_mean"] = pretrained_dict["features.41.running_mean"]
    net_dict["contract5.bn3.running_var"] = pretrained_dict["features.41.running_var"]

    return net_dict
